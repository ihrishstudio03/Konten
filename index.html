<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generator v6.3 (Anti-Overlap)</title>
<style>
    :root {
        --primary: #5d6d7e; 
        --secondary: #aeb6bf;
        --bg-color: #f2f3f4;
        --card-bg: #ffffff;
        --text-color: #2c3e50;
        --success: #27ae60;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        margin: 0;
        padding: 15px;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
    }

    .container {
        background: var(--card-bg);
        width: 100%;
        max-width: 720px;
        padding: 30px;
        border-radius: 18px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.08);
        border: 1px solid #d5dbdb;
    }

    h1 {
        text-align: center;
        color: var(--primary);
        font-size: 26px;
        margin: 0 0 5px 0;
        font-weight: 800;
    }

    p.subtitle {
        text-align: center;
        color: #7f8c8d;
        font-size: 13px;
        margin-bottom: 25px;
    }

    /* Highlight Box */
    .style-box {
        background: #ebf5fb;
        padding: 15px;
        border-radius: 12px;
        border: 2px solid #a9cce3;
        margin-bottom: 20px;
    }

    .dna-box {
        background: #f8f9f9;
        border: 1px solid #e5e7e9;
        padding: 15px;
        border-radius: 12px;
        margin-bottom: 20px;
    }

    .section-label {
        font-size: 11px;
        font-weight: 800;
        text-transform: uppercase;
        color: var(--primary);
        margin-bottom: 8px;
        letter-spacing: 0.5px;
    }

    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }

    @media (max-width: 600px) {
        .grid-2, .grid-3 { grid-template-columns: 1fr; }
    }

    label {
        display: block;
        font-size: 12px;
        font-weight: 700;
        margin-bottom: 5px;
        color: #555;
    }

    input, select {
        width: 100%;
        padding: 12px;
        border: 2px solid #e5e7e9;
        border-radius: 8px;
        font-size: 14px;
        box-sizing: border-box;
        transition: 0.2s;
        background: #fdfefe;
    }

    input:focus, select:focus {
        border-color: var(--primary);
        outline: none;
        background: #fff;
    }

    /* Slide Item */
    .slide-item {
        background: #fff;
        border: 1px solid #eee;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
        position: relative;
        box-shadow: 0 2px 5px rgba(0,0,0,0.02);
    }

    .slide-badge {
        position: absolute;
        top: -8px;
        left: 10px;
        background: var(--primary);
        color: white;
        padding: 3px 8px;
        border-radius: 10px;
        font-size: 10px;
        font-weight: bold;
    }

    .text-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid #f9f9f9;
    }
    @media (max-width: 600px) { .text-group { grid-template-columns: 1fr; } }

    button.generate-btn {
        width: 100%;
        background-color: var(--primary);
        color: white;
        border: none;
        padding: 16px;
        font-size: 15px;
        font-weight: 800;
        border-radius: 10px;
        cursor: pointer;
        transition: background 0.3s;
        margin-top: 15px;
    }
    button.generate-btn:hover { background-color: #34495e; }

    .result-box { margin-top: 30px; display: none; }
    
    .prompt-card {
        background: #222;
        color: #eee;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 12px;
        font-family: 'Consolas', monospace;
        font-size: 12px;
        line-height: 1.5;
        position: relative;
        border-left: 4px solid var(--secondary);
    }

    .prompt-content { margin-right: 60px; word-wrap: break-word; }

    .copy-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background: #555;
        color: white;
        border: none;
        padding: 5px 12px;
        border-radius: 4px;
        font-size: 10px;
        cursor: pointer;
        font-weight: bold;
    }
</style>
</head>
<body>

<div class="container">
    <h1>üé® Gen v6.3 (Anti-Overlap)</h1>
    <p class="subtitle">Layout Teks di Atas, Karakter di Bawah</p>

    <div class="style-box">
        <div class="grid-2">
            <div>
                <label style="color:var(--primary)">PILIH GAYA VISUAL</label>
                <select id="art-style" onchange="updateUIForStyle()" style="border-width:2px; border-color:var(--primary);">
                    <option value="paper">‚úÇÔ∏è 3D Paper Craft</option>
                    <option value="watercolor">üé® Watercolor (Cat Air)</option>
                </select>
            </div>
            <div>
                <label>Mode Konten</label>
                <select id="mode" onchange="toggleMode()">
                    <option value="single">Single Image</option>
                    <option value="carousel">Carousel (Cerita)</option>
                </select>
            </div>
        </div>
    </div>

    <div id="bg-color-container" style="display:block; margin-bottom:15px; background:#f0f0f0; padding:10px; border-radius:8px;">
         <label>üé® Warna Latar (Paper Mode)</label>
        <select id="bg-color">
            <optgroup label="Neutral">
                <option value="Warm Beige">Warm Beige</option>
                <option value="Clean White">Clean White</option>
            </optgroup>
            <optgroup label="Pastel">
                <option value="Soft Pastel Pink">Soft Pink</option>
                <option value="Pale Blue">Pale Blue</option>
                <option value="Soft Mint Green">Mint Green</option>
                <option value="Sunny Yellow">Sunny Yellow</option>
            </optgroup>
            <optgroup label="Bold">
                <option value="Deep Navy Blue">Navy Blue</option>
                <option value="Emerald Green">Emerald Green</option>
                <option value="Warm Sunset Orange">Sunset Orange</option>
            </optgroup>
        </select>
    </div>

    <div class="grid-2">
        <div>
             <label>Ikon Dekorasi</label>
            <input type="text" id="icons" value="Daun, awan, buku" placeholder="Benda...">
        </div>
        <div>
            <label>Rasio</label>
            <select id="ratio">
                <option value="--ar 4:5">Portrait (IG Feed)</option>
                <option value="--ar 1:1">Square (1:1)</option>
                <option value="--ar 9:16">Reels / Story</option>
            </select>
        </div>
    </div>
    
    <div style="margin-top:12px;">
        <label>Nama Akun Sosmed (Footer)</label>
        <input type="text" id="sosmed" placeholder="Contoh: @temanguru">
    </div>

    <div class="dna-box" style="margin-top:20px;">
        <div class="section-label">üß¨ Karakter Konsisten</div>
        <div class="grid-3">
            <div>
                <label>Gender</label>
                <select id="char-gender">
                    <option value="Muslim man">Pria Muslim</option>
                    <option value="Muslim woman hijab">Wanita Hijab</option>
                    <option value="Little Muslim boy">Anak Laki</option>
                    <option value="Little Muslim girl hijab">Anak Perempuan</option>
                </select>
            </div>
            <div>
                <label>Atasan</label>
                <input type="text" id="char-top" placeholder="Misal: Koko Putih">
            </div>
            <div>
                <label>Bawahan</label>
                <input type="text" id="char-bottom" placeholder="Misal: Sarung Biru">
            </div>
        </div>
    </div>

    <div id="single-area">
        <div class="slide-item">
            <div class="slide-badge">SINGLE POST</div>
            <label>Aktivitas</label>
            <input type="text" id="act-single" placeholder="Sedang apa?">
            <div class="text-group">
                <div><label>Judul (Besar)</label><input type="text" id="head-single"></div>
                <div><label>Sub-Teks (Kecil)</label><input type="text" id="sub-single"></div>
            </div>
        </div>
    </div>

    <div id="carousel-area" style="display:none">
        <div style="margin-bottom:15px;">
            <label>Jumlah Slide</label>
            <select id="slide-count" style="width:100px" onchange="renderSlides()">
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <div id="slides-container"></div>
    </div>

    <button class="generate-btn" onclick="generatePrompt()">‚ú® GENERATE PROMPT (Fixed Layout)</button>

    <div class="result-box" id="resultArea">
        <h3 style="text-align:center; font-size:14px; color:#555">HASIL PROMPT:</h3>
        <div id="outputContainer"></div>
    </div>
</div>

<script>
    // --- DICTIONARY FIX ---
    const dictionary = {
        "putih":"white", "hitam":"black", "merah":"red", "biru":"blue", "hijau":"green", 
        "kuning":"yellow", "coklat":"brown", "abu":"grey", "pink":"pink", "ungu":"purple", "krem":"beige",
        "koko":"koko shirt", "kemeja":"shirt", "kaos":"t-shirt", "gamis":"robe", "dress":"dress",
        "celana":"trousers", "sarung":"sarong", "rok":"skirt", 
        "duduk":"sitting", "berdiri":"standing", "baca":"reading", "sholat":"praying", 
        "jalan":"walking", "lari":"running", "tidur":"sleeping", "sujud":"sujud position",
        "menangis":"crying", "sedih":"sad", "senyum":"smiling", "merenung":"contemplating",
        "masjid":"mosque", "taman":"garden", "rumah":"house"
    };

    function translate(text) {
        if(!text) return "";
        let cleanText = text.toLowerCase();
        cleanText = cleanText.replace("baju koko", "koko shirt");
        cleanText = cleanText.replace("anak laki", "little boy");
        cleanText = cleanText.replace("anak perempuan", "little girl");
        cleanText = cleanText.replace("wanita hijab", "woman wearing hijab");
        return cleanText.split(' ').map(w => dictionary[w] || w).join(' ');
    }

    function toggleMode() {
        const isCarousel = document.getElementById('mode').value === 'carousel';
        document.getElementById('single-area').style.display = isCarousel ? 'none' : 'block';
        document.getElementById('carousel-area').style.display = isCarousel ? 'block' : 'none';
        if(isCarousel) renderSlides();
    }

    function updateUIForStyle() {
        const style = document.getElementById('art-style').value;
        document.getElementById('bg-color-container').style.display = style === 'paper' ? 'block' : 'none';
    }

    function renderSlides() {
        const count = document.getElementById('slide-count').value;
        const container = document.getElementById('slides-container');
        container.innerHTML = "";
        for(let i=1; i<=count; i++) {
            container.innerHTML += `
            <div class="slide-item">
                <div class="slide-badge">SLIDE ${i}</div>
                <label>Aktivitas</label>
                <input type="text" id="act-${i}" placeholder="Aktivitas...">
                <div class="text-group">
                    <div><label>Judul</label><input type="text" id="head-${i}"></div>
                    <div><label>Sub-Teks</label><input type="text" id="sub-${i}"></div>
                </div>
            </div>`;
        }
    }

    // --- LOGIKA LAYOUT ANTI-TABRAKAN ---
    function buildLayout(head, sub, sosmed, iconsRaw, bg, styleType) {
        
        let compositionInstruction = "";
        let textInstruction = "";

        // 1. Jika ada teks, paksa layout ATAS-BAWAH
        if (head || sub) {
            
            // Layout Teks: Di Ruang Kosong (Negative Space) bagian ATAS
            textInstruction = `. Text Layout: Big bold ${styleType === 'paper' ? '3D paper text' : 'watercolor typography'} "${head || ''}" placed in the top negative space (header area). `;
            if (sub) textInstruction += `Below the title, smaller clean text "${sub}". `;
            textInstruction += `Ensure text DOES NOT cover the character. `;

            // Komposisi: Karakter dipaksa ke BAWAH
            if (styleType === 'paper') {
                compositionInstruction = `Composition: Vertical layout. The character is positioned in the lower center section. Clean negative space at the top for text. Background: ${bg} background. `;
            } else {
                compositionInstruction = `Composition: Vertical layout. The character is placed in the bottom section of the paper. Vast empty watercolor paper texture at the top for typography. `;
            }

        } else {
            // Jika TIDAK ada teks, boleh layout TENGAH (lebih bebas)
            if (styleType === 'paper') {
                compositionInstruction = `Composition: Character in the center. Background: ${bg} background. `;
            } else {
                compositionInstruction = `Composition: Character centered. Textured watercolor paper background. `;
            }
        }

        // Dekorasi (Environment)
        let decor = "";
        if (styleType === 'paper') {
            decor = `Environment: Floating 3D paper ${iconsRaw} in the background and blurry bokeh ${iconsRaw} in the very front. `;
        } else {
            decor = `Environment: Surrounded by hand-painted ${iconsRaw} elements integrated into the paper texture. `;
        }

        // Footer Sosmed
        let footer = sosmed ? `Footer: Small text "${sosmed}" at the very bottom edge. ` : "";

        return { textPrompt: textInstruction, compPrompt: compositionInstruction, decor: decor, footer: footer };
    }

    function generatePrompt() {
        const selectedStyle = document.getElementById('art-style').value;
        const ratio = document.getElementById('ratio').value;
        const sosmed = document.getElementById('sosmed').value;
        let iconsRaw = translate(document.getElementById('icons').value) || "abstract shapes";
        const bg = document.getElementById('bg-color').value;

        // Base Style
        const paperStyle = "3D paper craft illustration, origami style, folded paper texture, low poly art";
        const waterStyle = "hand-drawn watercolor illustration, soft pastel and earthy tones, gentle lighting, emotional mood";
        const mainStyle = selectedStyle === 'paper' ? paperStyle : waterStyle;

        // DNA
        const gender = document.getElementById('char-gender').value;
        const top = translate(document.getElementById('char-top').value) || "cream shirt";
        const bot = translate(document.getElementById('char-bottom').value) || "brown trousers";
        const charDNA = `A faceless ${gender}, wearing ${top} and ${bot}, rendered in ${selectedStyle === 'paper' ? 'origami style' : 'watercolor style'}`;

        const mode = document.getElementById('mode').value;
        let html = "";

        if(mode === 'single') {
            let act = translate(document.getElementById('act-single').value) || "standing";
            const head = document.getElementById('head-single').value;
            const sub = document.getElementById('sub-single').value;
            
            // Build Layout Logic
            const layout = buildLayout(head, sub, sosmed, iconsRaw, bg, selectedStyle);
            
            const fullPrompt = `${mainStyle}. ${charDNA}, ${act}${layout.textPrompt} ${layout.compPrompt} ${layout.decor} ${layout.footer} high quality. ${ratio}`;
            html = makeCard("Single Post", fullPrompt);
        } else {
            const count = document.getElementById('slide-count').value;
            for(let i=1; i<=count; i++) {
                let act = translate(document.getElementById(`act-${i}`).value) || "standing";
                const head = document.getElementById(`head-${i}`).value;
                const sub = document.getElementById(`sub-${i}`).value;

                // Build Layout Logic per Slide
                const layout = buildLayout(head, sub, sosmed, iconsRaw, bg, selectedStyle);

                const fullPrompt = `${mainStyle}. ${charDNA}, ${act}${layout.textPrompt} ${layout.compPrompt} ${layout.decor} ${layout.footer} high quality. ${ratio}`;
                html += makeCard(`Slide ${i}`, fullPrompt);
            }
        }

        document.getElementById('outputContainer').innerHTML = html;
        document.getElementById('resultArea').style.display = 'block';
    }

    function makeCard(title, text) {
        const uniqueId = "prompt-" + Math.random().toString(36).substr(2, 9);
        return `
        <div class="prompt-card">
            <div style="margin-bottom:5px; color:#aaa; font-size:10px; text-transform:uppercase; font-weight:bold;">${title}</div>
            <div id="${uniqueId}" class="prompt-content">${text}</div>
            <button class="copy-btn" onclick="copySafe('${uniqueId}', this)">COPY</button>
        </div>`;
    }

    function copySafe(elementId, btnElement) {
        const textToCopy = document.getElementById(elementId).innerText;
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(textToCopy).then(() => showCopied(btnElement)).catch(() => fallbackCopy(textToCopy, btnElement));
        } else {
            fallbackCopy(textToCopy, btnElement);
        }
    }

    function fallbackCopy(text, btnElement) {
        let textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed"; textArea.style.left = "-9999px";
        document.body.appendChild(textArea);
        textArea.focus(); textArea.select();
        try { document.execCommand('copy'); showCopied(btnElement); } catch (err) { alert('Copy manual: ' + text); }
        document.body.removeChild(textArea);
    }

    function showCopied(btnElement) {
        const originalText = btnElement.innerText;
        btnElement.innerText = "OK!";
        btnElement.style.background = "#27ae60";
        setTimeout(() => {
            btnElement.innerText = originalText;
            btnElement.style.background = "#555";
        }, 1500);
    }

    renderSlides();
    updateUIForStyle();
</script>

</body>
</html>
