<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generator v9.0 (Instant Image)</title>
<style>
    :root {
        --primary: #2d3436; 
        --accent: #00cec9;
        --bg-color: #dfe6e9;
        --card-bg: #ffffff;
        --text: #2d3436;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--bg-color);
        color: var(--text);
        margin: 0;
        padding: 20px;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
    }

    .container {
        background: var(--card-bg);
        width: 100%;
        max-width: 800px;
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 20px 50px rgba(0,0,0,0.1);
    }

    h1 {
        text-align: center;
        color: var(--primary);
        font-size: 28px;
        margin: 0 0 5px 0;
        font-weight: 800;
    }

    p.subtitle {
        text-align: center;
        color: #636e72;
        font-size: 14px;
        margin-bottom: 25px;
    }

    /* BOX STYLING */
    .control-box {
        background: #f1f2f6;
        padding: 20px;
        border-radius: 15px;
        border: 1px solid #dfe4ea;
        margin-bottom: 20px;
    }

    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }

    @media (max-width: 600px) {
        .grid-2, .grid-3 { grid-template-columns: 1fr; }
    }

    label {
        display: block;
        font-size: 12px;
        font-weight: 700;
        margin-bottom: 6px;
        color: #636e72;
    }

    input, select {
        width: 100%;
        padding: 14px;
        border: 2px solid #dfe6e9;
        border-radius: 10px;
        font-size: 14px;
        box-sizing: border-box;
        transition: 0.2s;
        background: #fff;
    }

    input:focus, select:focus {
        border-color: var(--primary);
        outline: none;
    }

    /* IMAGE RESULT AREA */
    .image-result-container {
        margin-top: 30px;
        text-align: center;
        background: #2d3436;
        padding: 20px;
        border-radius: 15px;
        min-height: 300px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
    }

    #generated-image {
        max-width: 100%;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        display: none; /* Hidden by default */
    }

    .loader {
        border: 5px solid #f3f3f3;
        border-top: 5px solid var(--accent);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        display: none;
        margin-bottom: 15px;
    }

    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    button.generate-btn {
        width: 100%;
        background-color: var(--primary);
        color: white;
        border: none;
        padding: 18px;
        font-size: 16px;
        font-weight: 800;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
        margin-top: 20px;
        box-shadow: 0 4px 0 #000;
    }
    button.generate-btn:hover { transform: translateY(-2px); background-color: #000; }
    button.generate-btn:active { transform: translateY(2px); box-shadow: none; }

    .prompt-text-small {
        font-size: 10px;
        color: #b2bec3;
        margin-top: 10px;
        word-break: break-all;
        display: none;
    }
</style>
</head>
<body>

<div class="container">
    <h1>üé® Generator v9.0</h1>
    <p class="subtitle">Direct Image Generation (No External App Needed)</p>

    <div class="control-box">
        <div class="grid-2">
            <div>
                <label>Gaya Visual</label>
                <select id="art-style" onchange="updateUIForStyle()" style="font-weight:bold;">
                    <option value="paper">‚úÇÔ∏è 3D Paper Craft</option>
                    <option value="watercolor">üé® Watercolor (Cat Air)</option>
                </select>
            </div>
            <div>
                <label>Rasio Gambar</label>
                <select id="ratio">
                    <option value="1:1">Square (1:1)</option>
                    <option value="3:4">Portrait (3:4)</option>
                    <option value="16:9">Landscape (16:9)</option>
                </select>
            </div>
        </div>
    </div>

    <div class="grid-2">
        <div id="bg-color-wrapper">
             <label>Warna Latar</label>
            <select id="bg-color">
                <option value="Warm Beige">Warm Beige</option>
                <option value="Clean White">Clean White</option>
                <option value="Soft Pastel Pink">Soft Pink</option>
                <option value="Pale Blue">Pale Blue</option>
                <option value="Soft Mint Green">Mint Green</option>
                <option value="Deep Navy Blue">Navy Blue</option>
            </select>
        </div>
        <div>
             <label>Ikon Dekorasi</label>
            <input type="text" id="icons" value="Buku, awan, lampu" placeholder="Benda...">
        </div>
    </div>
    
    <div class="control-box" style="margin-top:15px;">
        <label style="color:var(--primary); margin-bottom:10px;">üß¨ KARAKTER</label>
        <div class="grid-3">
            <div>
                <select id="char-gender">
                    <option value="Muslim man">Pria Muslim</option>
                    <option value="Muslim woman hijab">Wanita Hijab</option>
                    <option value="Little Muslim boy">Anak Laki</option>
                    <option value="Little Muslim girl hijab">Anak Perempuan</option>
                </select>
            </div>
            <div><input type="text" id="char-top" placeholder="Atasan (Warna)"></div>
            <div><input type="text" id="char-bottom" placeholder="Bawahan (Warna)"></div>
        </div>
    </div>

    <div class="control-box">
        <label>Aktivitas & Teks</label>
        <input type="text" id="activity" placeholder="Sedang apa? (Misal: Duduk berdoa)" style="margin-bottom:10px;">
        <div class="grid-2">
            <input type="text" id="head-text" placeholder="Judul Utama (Opsional)">
            <input type="text" id="sub-text" placeholder="Sub-Teks (Opsional)">
        </div>
        <div style="margin-top:10px;">
             <input type="text" id="sosmed" placeholder="Footer Sosmed (Contoh: @temanguru)">
        </div>
    </div>

    <button class="generate-btn" onclick="generateAndRender()">‚ú® BUAT GAMBAR SEKARANG</button>

    <div class="image-result-container" id="result-container">
        <div class="loader" id="loader"></div>
        <p id="status-text">Siap membuat gambar...</p>
        <img id="generated-image" alt="Hasil Gambar" />
        <p class="prompt-text-small" id="final-prompt-display"></p>
        
        <div id="action-buttons" style="display:none; margin-top:15px; width:100%; gap:10px;">
            <button onclick="downloadImage()" style="background:#00b894; border:none; padding:10px 20px; color:white; border-radius:5px; cursor:pointer; font-weight:bold;">‚¨áÔ∏è Download</button>
        </div>
    </div>

</div>

<script>
    // --- KAMUS TRANSLATE ---
    const dictionary = {
        "putih":"white", "hitam":"black", "merah":"red", "biru":"blue", "hijau":"green", 
        "kuning":"yellow", "coklat":"brown", "abu":"grey", "koko":"koko shirt", 
        "kemeja":"shirt", "kaos":"t-shirt", "gamis":"robe", "celana":"trousers", 
        "sarung":"sarong", "rok":"skirt", "jilbab":"hijab", "duduk":"sitting", 
        "berdiri":"standing", "baca":"reading", "sholat":"praying"
    };

    function translate(text) {
        if(!text) return "";
        let cleanText = text.toLowerCase();
        cleanText = cleanText.replace("baju koko", "koko shirt");
        cleanText = cleanText.replace("wanita hijab", "woman wearing hijab");
        return cleanText.split(' ').map(w => dictionary[w] || w).join(' ');
    }

    function updateUIForStyle() {
        const style = document.getElementById('art-style').value;
        document.getElementById('bg-color-wrapper').style.opacity = style === 'paper' ? '1' : '0.5';
    }

    // --- LOGIKA UTAMA GENERASI GAMBAR ---
    async function generateAndRender() {
        // 1. UI Loading
        const loader = document.getElementById('loader');
        const statusText = document.getElementById('status-text');
        const imgElement = document.getElementById('generated-image');
        const btnGroup = document.getElementById('action-buttons');
        
        loader.style.display = 'block';
        statusText.innerText = "Sedang menggambar... (Tunggu 5-10 detik)";
        statusText.style.display = 'block';
        imgElement.style.display = 'none';
        btnGroup.style.display = 'none';

        // 2. BUILD PROMPT
        const styleType = document.getElementById('art-style').value;
        const ratio = document.getElementById('ratio').value;
        
        // Setup Style
        let mainStyle = "", envPrompt = "", textStyle = "";
        const bg = document.getElementById('bg-color').value;
        const icons = translate(document.getElementById('icons').value) || "shapes";

        if (styleType === 'paper') {
            mainStyle = "3D paper craft illustration, origami style, folded paper texture, low poly art, minimalist";
            textStyle = "3D paper text";
            envPrompt = `Floating 3D paper ${icons} in background, ${bg} background`;
        } else {
            mainStyle = "Hand-drawn watercolor illustration, soft pastel tones, emotional mood, storybook style";
            textStyle = "watercolor typography";
            envPrompt = `Hand-painted ${icons} elements, textured paper background`;
        }

        // Setup Char
        const gender = document.getElementById('char-gender').value;
        const top = translate(document.getElementById('char-top').value) || "white shirt";
        const bot = translate(document.getElementById('char-bottom').value) || "blue pants";
        const charDNA = `Cute stylized faceless ${gender}, cartoon proportions, simplified anatomy, wearing ${top} and ${bot}`;

        // Setup Content
        const act = translate(document.getElementById('activity').value) || "standing";
        const head = document.getElementById('head-text').value;
        const sub = document.getElementById('sub-text').value;
        const sosmed = document.getElementById('sosmed').value;

        let textPrompt = "";
        if(head) textPrompt += `Big text "${head}" at top. `;
        if(sub) textPrompt += `Small text "${sub}" below title. `;
        if(sosmed) textPrompt += `Tiny text "${sosmed}" at very bottom. `;

        // Final Prompt String
        const fullPrompt = `${mainStyle}. ${charDNA}, ${act}. ${textPrompt} ${envPrompt}. High quality, 8k.`;
        
        document.getElementById('final-prompt-display').innerText = fullPrompt;

        // 3. PANGGIL API GAMBAR (Pollinations.ai - Free & No Key Required)
        // Kita atur width/height berdasarkan rasio
        let width = 1024;
        let height = 1024;
        if(ratio === '3:4') { width = 768; height = 1024; }
        if(ratio === '16:9') { width = 1024; height = 576; }

        // Random seed agar gambar selalu baru
        const seed = Math.floor(Math.random() * 1000000);
        
        // URL API
        const encodedPrompt = encodeURIComponent(fullPrompt);
        const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?width=${width}&height=${height}&seed=${seed}&model=flux&nologo=true`;

        // 4. LOAD IMAGE
        imgElement.onload = function() {
            loader.style.display = 'none';
            statusText.style.display = 'none';
            imgElement.style.display = 'block';
            btnGroup.style.display = 'flex';
        };
        
        imgElement.onerror = function() {
            loader.style.display = 'none';
            statusText.innerText = "Gagal memuat gambar. Coba lagi.";
        };

        imgElement.src = imageUrl;
    }

    function downloadImage() {
        const img = document.getElementById('generated-image');
        const link = document.createElement('a');
        link.href = img.src;
        link.download = 'hasil-gambar.png';
        link.target = '_blank';
        link.click();
    }
</script>

</body>
</html>
